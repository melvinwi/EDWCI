
h2. ARTEFACT: TRANSFORM_DimService

DESCRIPTION: Promote services from Orion site table to DataStore

|*SOURCE_FUNCTION_PREFIX*	|*SOURCE*	|*SOURCE_FUNCTION_SUFFIX*	|*DESTINATION*	|*DESCRIPTION*	|
|CAST(	|"utl_site":../staging/utl_site.textile .site_id	|AS int)	|"DimService":../datastore/DimService.textile .ServiceKey	|One to one mapping with int cast	|
|CAST(	|"utl_site":../staging/utl_site.textile .site_identifier	|AS nvarchar(30))	|"DimService":../datastore/DimService.textile .MarketIdentifier	|One to one mapping with nvarchar cast	|
|CAST(CASE	|"utl_site":../staging/utl_site.textile .seq_product_type_id	|WHEN '1' THEN 'Internet' WHEN '2' THEN 'Electricity' WHEN '3' THEN 'Gas' WHEN '7' THEN 'Telco' ELSE NULL END AS nvarchar(11))	|"DimService":../datastore/DimService.textile .ServiceType	|One to one mapping with nvarchar cast	|
|	|"utl_distrib_loss_factor_sched":../staging/utl_distrib_loss_factor_sched.textile .dlf_factor	|	|"DimService":../datastore/DimService.textile .LossFactor	|One to one mapping	|
|SELECTION_CRITERIA	|"FROM [schema]."utl_site":../staging/utl_site.textile  INNER JOIN [schema]."utl_distrib_loss_factor_sched":../staging/utl_distrib_loss_factor_sched.textile  ON "utl_distrib_loss_factor_sched":../staging/utl_distrib_loss_factor_sched.textile .dlf_id = ISNULL("utl_site":../staging/utl_site.textile .dlf_id,4) WHERE "utl_distrib_loss_factor_sched":../staging/utl_distrib_loss_factor_sched.textile .start_date < GETDATE() AND ISNULL("utl_distrib_loss_factor_sched":../staging/utl_distrib_loss_factor_sched.textile .end_date,'9999-12-31') > GETDATE() AND ("utl_site":../staging/utl_site.textile .Meta_LatestUpdate_TaskExecutionInstanceId  > @LatestSuccessfulTaskExecutionInstanceID OR "utl_distrib_loss_factor_sched":../staging/utl_distrib_loss_factor_sched.textile .Meta_LatestUpdate_TaskExecutionInstanceId  > @LatestSuccessfulTaskExecutionInstanceID)"|

