
h2. ARTEFACT: TRANSFORM_DimTransmissionNode

DESCRIPTION: Promote Transmission Nodes from Orion reference tables to DataStore

|*SOURCE_FUNCTION_PREFIX*	|*SOURCE*	|*SOURCE_FUNCTION_SUFFIX*	|*DESTINATION*	|*DESCRIPTION*	|
|CAST(	|""utl_network":../staging/utl_network.textile _node":../staging/"utl_network":../staging/utl_network.textile _node.textile .network_node_id	|AS int)	|"DimTransmissionNode":../datastore/DimTransmissionNode.textile .TransmissionNodeKey	|One to one mapping with int cast	|
|CAST(	|""utl_network":../staging/utl_network.textile _node":../staging/"utl_network":../staging/utl_network.textile _node.textile .network_node_code	|AS nvarchar(20))	|"DimTransmissionNode":../datastore/DimTransmissionNode.textile .TransmissionNodeIdentity	|One to one mapping with nvarchar cast	|
|CAST(	|""utl_network":../staging/utl_network.textile _node":../staging/"utl_network":../staging/utl_network.textile _node.textile .network_node_desc	|AS nvarchar(100))	|"DimTransmissionNode":../datastore/DimTransmissionNode.textile .TransmissionNodeName	|One to one mapping with nvarchar cast	|
|CAST(	|""utl_network":../staging/utl_network.textile _region":../staging/"utl_network":../staging/utl_network.textile _region.textile .region_code	|AS nchar(3))	|"DimTransmissionNode":../datastore/DimTransmissionNode.textile .TransmissionNodeState	|	|
|CAST(	|"utl_network":../staging/utl_network.textile .network_desc	|AS nvarchar(100))	|"DimTransmissionNode":../datastore/DimTransmissionNode.textile .TransmissionNodeNetwork	|	|
|CAST(CASE	|"utl_network":../staging/utl_network.textile .seq_product_type_id	|WHEN '1' THEN 'Internet' WHEN '2' THEN 'Electricity' WHEN '3' THEN 'Gas' WHEN '7' THEN 'Telco' ELSE NULL END AS nvarchar(11))	|"DimTransmissionNode":../datastore/DimTransmissionNode.textile .TransmissionNodeServiceType	|One to one mapping with nvarchar cast	|
|COALESCE (	|""utl_network":../staging/utl_network.textile _node":../staging/"utl_network":../staging/utl_network.textile _node.textile .loss_factor	|", 1.0 )"	|"DimTransmissionNode":../datastore/DimTransmissionNode.textile .TransmissionNodeLossFactor	|One to one mapping	|
|SELECTION_CRITERIA	|FROM [schema].""utl_network":../staging/utl_network.textile _node":../staging/"utl_network":../staging/utl_network.textile _node.textile  INNER JOIN [schema]."utl_network":../staging/utl_network.textile  ON "utl_network":../staging/utl_network.textile .network_id = ""utl_network":../staging/utl_network.textile _node":../staging/"utl_network":../staging/utl_network.textile _node.textile .network_id LEFT JOIN [schema].""utl_network":../staging/utl_network.textile _region":../staging/"utl_network":../staging/utl_network.textile _region.textile  ON ""utl_network":../staging/utl_network.textile _node":../staging/"utl_network":../staging/utl_network.textile _node.textile .region_id = ""utl_network":../staging/utl_network.textile _region":../staging/"utl_network":../staging/utl_network.textile _region.textile .region_id WHERE (""utl_network":../staging/utl_network.textile _node":../staging/"utl_network":../staging/utl_network.textile _node.textile .Meta_LatestUpdate_TaskExecutionInstanceId  > @LatestSuccessfulTaskExecutionInstanceID OR "utl_network":../staging/utl_network.textile .Meta_LatestUpdate_TaskExecutionInstanceId  > @LatestSuccessfulTaskExecutionInstanceID OR ""utl_network":../staging/utl_network.textile _region":../staging/"utl_network":../staging/utl_network.textile _region.textile .Meta_LatestUpdate_TaskExecutionInstanceId  > @LatestSuccessfulTaskExecutionInstanceID)|

