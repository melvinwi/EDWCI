
h2. ARTEFACT: TRANSFORM_CUSTOMER

DESCRIPTION: Promote Customer from CRM and ACCOUNT systems to DataStore

|*SOURCE_FUNCTION_PREFIX*	|*SOURCE*	|*SOURCE_FUNCTION_SUFFIX*	|*DESTINATION*	|*DESCRIPTION*	|
|	|"STAGING_CUSTOMER":../staging/STAGING_CUSTOMER.textile .NUMBER	|	|"DATASTORE_CUSTOMER":../datastore/DATASTORE_CUSTOMER.textile .NUMBER	|	|
|	|"STAGING_CUSTOMER":../staging/STAGING_CUSTOMER.textile .FIRSTNAME	|	|"DATASTORE_CUSTOMER":../datastore/DATASTORE_CUSTOMER.textile .FIRST_NAME	|	|
|	|"STAGING_CUSTOMER":../staging/STAGING_CUSTOMER.textile .SURNAME	|	|"DATASTORE_CUSTOMER":../datastore/DATASTORE_CUSTOMER.textile .LAST_NAME	|	|
|	|"STAGING_CUSTOMER":../staging/STAGING_CUSTOMER.textile .MIDDLENAME	|	|"DATASTORE_CUSTOMER":../datastore/DATASTORE_CUSTOMER.textile .MIDDLE_NAME	|	|
|	|"STAGING_CUSTOMER":../staging/STAGING_CUSTOMER.textile .UPDATED_DATETIME	|	|"DATASTORE_CUSTOMER":../datastore/DATASTORE_CUSTOMER.textile .UPDATED_DT	|	|
|	|"STAGING_CUSTOMER":../staging/STAGING_CUSTOMER.textile _ACCOUNT.ACCOUNT_ID	|	|"DATASTORE_CUSTOMER":../datastore/DATASTORE_CUSTOMER.textile .ACCOUNT_ID	|	|
|	|"STAGING_CUSTOMER":../staging/STAGING_CUSTOMER.textile _ACCOUNT.ACCOUNT_NAME	|	|"DATASTORE_CUSTOMER":../datastore/DATASTORE_CUSTOMER.textile .ACCOUNT_NAME	|	|
|SUBSTRING(	|"STAGING_CUSTOMER":../staging/STAGING_CUSTOMER.textile _ACCOUNT.ACCOUNT_TYPE_ID	| , 1, 1)	|"DATASTORE_CUSTOMER":../datastore/DATASTORE_CUSTOMER.textile .ACCOUNT_TYPE_ID	|first character	|
|SELECTION_CRITERIA	|WHERE `"STAGING_CUSTOMER":../staging/STAGING_CUSTOMER.textile `.`NUMBER` = `"STAGING_CUSTOMER":../staging/STAGING_CUSTOMER.textile _ACCOUNT`.`CUSTOMER_NUMBER` and `"STAGING_CUSTOMER":../staging/STAGING_CUSTOMER.textile `.`NUMBER` is not null|

