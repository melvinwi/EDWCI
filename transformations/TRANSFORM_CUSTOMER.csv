# design artefact				
# ARTEFACT: TRANSFORM_CUSTOMER				
# DESCRIPTION: Promote Customer from CRM and ACCOUNT systems to DataStore 				
SOURCE_FUNCTION_PREFIX	SOURCE	SOURCE_FUNCTION_SUFFIX	DESTINATION	DESCRIPTION
	STAGING_CUSTOMER.NUMBER		DATASTORE_CUSTOMER.NUMBER	
	STAGING_CUSTOMER.FIRSTNAME		DATASTORE_CUSTOMER.FIRST_NAME	
	STAGING_CUSTOMER.SURNAME		DATASTORE_CUSTOMER.LAST_NAME	
	STAGING_CUSTOMER.MIDDLENAME		DATASTORE_CUSTOMER.MIDDLE_NAME	
	STAGING_CUSTOMER.UPDATED_DATETIME		DATASTORE_CUSTOMER.UPDATED_DT	
	STAGING_CUSTOMER_ACCOUNT.ACCOUNT_ID		DATASTORE_CUSTOMER.ACCOUNT_ID	
	STAGING_CUSTOMER_ACCOUNT.ACCOUNT_NAME		DATASTORE_CUSTOMER.ACCOUNT_NAME	
SUBSTRING(	STAGING_CUSTOMER_ACCOUNT.ACCOUNT_TYPE_ID	 , 0, 2)	DATASTORE_CUSTOMER.ACCOUNT_TYPE_ID	first character
SELECTION_CRITERIA	WHERE `STAGING_CUSTOMER`.`NUMBER` = `STAGING_CUSTOMER_ACCOUNT`.`CUSTOMER_NUMBER` and `STAGING_CUSTOMER`.`NUMBER` is not null			