# design test artefact			
# ARTEFACT: TRANSFORM_DimService_tests			
# DESCRIPTION: Test each transformation rule			
SOURCE_SELECTION_CRITERIA	DESTINATION_SELECTION_CRITERIA	TEST	DESCRIPTION
REUSE_SQL	"FROM /* Staging */ [schema].Level2_CSVData INNER JOIN /* Staging */ [schema].Level2_Transaction ON Level2_Transaction.transactionID = Level2_CSVData.transactionID LEFT JOIN (SELECT DimService.ServiceId, DimService.MarketIdentifier, ROW_NUMBER() OVER (PARTITION BY DimService.MarketIdentifier ORDER BY DimService.Meta_EffectiveStartDate DESC) AS recency FROM /* Dimensional */ staticDims.DimService) AS _dimService ON _dimService.MarketIdentifier = Level2_CSVData.NMI AND _dimService.recency = 1 LEFT JOIN (SELECT DimTransmissionNode.TransmissionNodeId, DimTransmissionNode.TransmissionNodeIdentity, ROW_NUMBER() OVER (PARTITION BY DimTransmissionNode.TransmissionNodeIdentity ORDER BY DimTransmissionNode.TransmissionNodeKey DESC) AS recency FROM /* Dimensional */ staticDims.DimTransmissionNode) AS _dimTransmissionNode ON _dimTransmissionNode.TransmissionNodeIdentity = Level2_CSVData.TNI AND _dimTransmissionNode.recency = 1 WHERE Level2_CSVData.Meta_LatestUpdate_TaskExecutionInstanceId > -2"		
[REUSE_SQL]		source.length.should.equal(destination.length)	row counts should match
