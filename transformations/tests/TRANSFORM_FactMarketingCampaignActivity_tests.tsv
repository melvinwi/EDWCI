# test artefact			
# ARTEFACT: TRANSFORM_FactMarketingCampaignActivity_tests			
# DESCRIPTION: Test each transformation rule			
SOURCE_SELECTION_CRITERIA	DESTINATION_SELECTION_CRITERIA	TEST	DESCRIPTION
FROM [schema].csv_FactMarketingCampaignActivity INNER JOIN staticdims.DimCustomer as _DimCustomer ON _DimCustomer.CustomerKey = csv_FactMarketingCampaignActivity.CustomerKey AND _DimCustomer.Meta_IsCurrent = 1		source.length.should.equal(destination.length)	row counts should match
FROM [schema].csv_FactMarketingCampaignActivity INNER JOIN staticdims.DimCustomer as _DimCustomer ON _DimCustomer.CustomerKey = csv_FactMarketingCampaignActivity.CustomerKey AND _DimCustomer.Meta_IsCurrent = 1 AND MarketingCampaignId = '1'	WHERE MarketingCampaignId = '1'	source[0].MarketingCampaignId.should.equal(destination[0].MarketingCampaignId)	one to one
FROM [schema].csv_FactMarketingCampaignActivity INNER JOIN staticdims.DimCustomer as _DimCustomer ON _DimCustomer.CustomerKey = csv_FactMarketingCampaignActivity.CustomerKey AND _DimCustomer.Meta_IsCurrent = 1 AND MarketingCampaignId = '1'	WHERE MarketingCampaignId = '1'	source[0].MarketingOfferId.should.equal(destination[0].MarketingOfferId)	one to one
FROM [schema].csv_FactMarketingCampaignActivity INNER JOIN staticdims.DimCustomer as _DimCustomer ON _DimCustomer.CustomerKey = csv_FactMarketingCampaignActivity.CustomerKey AND _DimCustomer.Meta_IsCurrent = 1 AND MarketingCampaignId = '1'	WHERE MarketingCampaignId = '1'	source[0].CustomerId.should.equal(destination[0].CustomerId)	one to one
FROM [schema].csv_FactMarketingCampaignActivity INNER JOIN staticdims.DimCustomer as _DimCustomer ON _DimCustomer.CustomerKey = csv_FactMarketingCampaignActivity.CustomerKey AND _DimCustomer.Meta_IsCurrent = 1 AND MarketingCampaignId = '1'	WHERE MarketingCampaignId = '1'	Number(source[0].ActivityDateId.replace(/-/g, '')).should.equal(destination[0].ActivityDateId)	one to one
FROM [schema].csv_FactMarketingCampaignActivity INNER JOIN staticdims.DimCustomer as _DimCustomer ON _DimCustomer.CustomerKey = csv_FactMarketingCampaignActivity.CustomerKey AND _DimCustomer.Meta_IsCurrent = 1 AND MarketingCampaignId = '1'	WHERE MarketingCampaignId = '1'	source[0].ActivityType.should.equal(destination[0].ActivityType)	one to one
FROM [schema].csv_FactMarketingCampaignActivity INNER JOIN staticdims.DimCustomer as _DimCustomer ON _DimCustomer.CustomerKey = csv_FactMarketingCampaignActivity.CustomerKey AND _DimCustomer.Meta_IsCurrent = 1 AND MarketingCampaignId = '1'	WHERE MarketingCampaignId = '1'	(source[0].MarketingCampaignActivityKey+'-'+source[0].CustomerKey+'-'+source[0].ActivityDateId+'-'+source[0].ActivityTime).should.equal(destination[0].MarketingCampaignActivityKey)	one to one