# test artefact
# ARTEFACT: TRANSFORM_DimCustomer_tests
# DESCRIPTION: Test each transformation rule
SOURCE_SELECTION_CRITERIA	DESTINATION_SELECTION_CRITERIA	TEST	DESCRIPTION
FROM lumo.nc_client, lumo.crm_party, lumo.crm_element_hierarchy WHERE nc_client.seq_party_id = crm_party.seq_party_id AND crm_element_hierarchy.element_id = crm_party.seq_party_id	source.length.should.equal(destination.length)	row counts should match
FROM lumo.nc_client, lumo.crm_party, lumo.crm_element_hierarchy WHERE nc_client.seq_party_id = crm_party.seq_party_id AND crm_element_hierarchy.element_id = crm_party.seq_party_id AND party_code = '1705150'	WHERE CustomerCode = '1705150'	source[0].party_code.should.equal(destination[0].CustomerCode)	one to one
FROM lumo.nc_client, lumo.crm_party, lumo.crm_element_hierarchy WHERE nc_client.seq_party_id = crm_party.seq_party_id AND crm_element_hierarchy.element_id = crm_party.seq_party_id AND party_code = '1705150'	WHERE CustomerCode = '1705150'	source[0].seq_party_id.should.equal(destination[0].CustomerKey)	one to one
FROM lumo.nc_client, lumo.crm_party, lumo.crm_element_hierarchy WHERE nc_client.seq_party_id = crm_party.seq_party_id AND crm_element_hierarchy.element_id = crm_party.seq_party_id AND party_code = '1705150'	WHERE CustomerCode = '1705150'	source[0].title.should.equal(destination[0].Title)	one to one
FROM lumo.nc_client, lumo.crm_party, lumo.crm_element_hierarchy WHERE nc_client.seq_party_id = crm_party.seq_party_id AND crm_element_hierarchy.element_id = crm_party.seq_party_id AND party_code = '1705150'	WHERE CustomerCode = '1705150'	source[0].first_name.should.equal(destination[0].Firstname)	one to one
FROM lumo.nc_client, lumo.crm_party, lumo.crm_element_hierarchy WHERE nc_client.seq_party_id = crm_party.seq_party_id AND crm_element_hierarchy.element_id = crm_party.seq_party_id AND party_code = '1705150'	WHERE CustomerCode = '1705150'	source[0].initials.should.equal(destination[0].MiddleInitial)	one to one
FROM lumo.nc_client, lumo.crm_party, lumo.crm_element_hierarchy WHERE nc_client.seq_party_id = crm_party.seq_party_id AND crm_element_hierarchy.element_id = crm_party.seq_party_id AND party_code = '1705150'	WHERE CustomerCode = '1705150'	source[0].last_name.should.equal(destination[0].LastName)	one to one
FROM lumo.nc_client, lumo.crm_party, lumo.crm_element_hierarchy WHERE nc_client.seq_party_id = crm_party.seq_party_id AND crm_element_hierarchy.element_id = crm_party.seq_party_id AND party_code = '1705150'	WHERE CustomerCode = '1705150'	source[0].party_name.should.equal(destination[0].PartyName)	one to one
FROM lumo.nc_client, lumo.crm_party, lumo.crm_element_hierarchy WHERE nc_client.seq_party_id = crm_party.seq_party_id AND crm_element_hierarchy.element_id = crm_party.seq_party_id AND party_code = '1705150'	WHERE CustomerCode = '1705150'	source[0].postal_addr_1.should.equal(destination[0].PostalAddressLine1)	one to one
FROM lumo.nc_client, lumo.crm_party, lumo.crm_element_hierarchy WHERE nc_client.seq_party_id = crm_party.seq_party_id AND crm_element_hierarchy.element_id = crm_party.seq_party_id AND party_code = '1705150'	WHERE CustomerCode = '1705150'	source[0].postal_addr_2.should.equal(destination[0].PostalSuburb)	one to one
FROM lumo.nc_client, lumo.crm_party, lumo.crm_element_hierarchy WHERE nc_client.seq_party_id = crm_party.seq_party_id AND crm_element_hierarchy.element_id = crm_party.seq_party_id AND party_code = '1705150'	WHERE CustomerCode = '1705150'	source[0].postal_post_code.should.equal(destination[0].PostalPostcode)	one to one
FROM lumo.nc_client, lumo.crm_party, lumo.crm_element_hierarchy WHERE nc_client.seq_party_id = crm_party.seq_party_id AND crm_element_hierarchy.element_id = crm_party.seq_party_id AND party_code = '1705150'	WHERE CustomerCode = '1705150'	source[0].postal_addr_3.should.equal(destination[0].PostalState)	one to one
FROM lumo.nc_client, lumo.crm_party, lumo.crm_element_hierarchy WHERE nc_client.seq_party_id = crm_party.seq_party_id AND crm_element_hierarchy.element_id = crm_party.seq_party_id AND party_code = '1705150'	WHERE CustomerCode = '1705150'	source[0].street_addr_1.should.equal(destination[0].ResidentialAddressLine1)	one to one
FROM lumo.nc_client, lumo.crm_party, lumo.crm_element_hierarchy WHERE nc_client.seq_party_id = crm_party.seq_party_id AND crm_element_hierarchy.element_id = crm_party.seq_party_id AND party_code = '1705150'	WHERE CustomerCode = '1705150'	source[0].street_addr_2.should.equal(destination[0].ResidentialSuburb)	one to one
FROM lumo.nc_client, lumo.crm_party, lumo.crm_element_hierarchy WHERE nc_client.seq_party_id = crm_party.seq_party_id AND crm_element_hierarchy.element_id = crm_party.seq_party_id AND party_code = '1705150'	WHERE CustomerCode = '1705150'	source[0].street_post_code.should.equal(destination[0].ResidentialPostcode)	one to one
FROM lumo.nc_client, lumo.crm_party, lumo.crm_element_hierarchy WHERE nc_client.seq_party_id = crm_party.seq_party_id AND crm_element_hierarchy.element_id = crm_party.seq_party_id AND party_code = '1705150'	WHERE CustomerCode = '1705150'	source[0].street_addr_3.should.equal(destination[0].ResidentialState)	one to one
FROM lumo.nc_client, lumo.crm_party, lumo.crm_element_hierarchy WHERE nc_client.seq_party_id = crm_party.seq_party_id AND crm_element_hierarchy.element_id = crm_party.seq_party_id AND party_code = '1705150'	WHERE CustomerCode = '1705150'	source[0].std_code.should.equal(destination[0].PrimaryPhone)	one to one
FROM lumo.nc_client, lumo.crm_party, lumo.crm_element_hierarchy WHERE nc_client.seq_party_id = crm_party.seq_party_id AND crm_element_hierarchy.element_id = crm_party.seq_party_id AND party_code = '1705150'	WHERE CustomerCode = '1705150'	source[0].primary_phone_type_id.should.equal(destination[0].PrimaryPhoneType)	one to one
FROM lumo.nc_client, lumo.crm_party, lumo.crm_element_hierarchy WHERE nc_client.seq_party_id = crm_party.seq_party_id AND crm_element_hierarchy.element_id = crm_party.seq_party_id AND party_code = '1705150'	WHERE CustomerCode = '1705150'	source[0].secondary_std_code.should.equal(destination[0].SecondaryPhone)	one to one
FROM lumo.nc_client, lumo.crm_party, lumo.crm_element_hierarchy WHERE nc_client.seq_party_id = crm_party.seq_party_id AND crm_element_hierarchy.element_id = crm_party.seq_party_id AND party_code = '1705150'	WHERE CustomerCode = '1705150'	source[0].secondary_phone_type_id.should.equal(destination[0].SecondaryPhoneType)	one to one
FROM lumo.nc_client, lumo.crm_party, lumo.crm_element_hierarchy WHERE nc_client.seq_party_id = crm_party.seq_party_id AND crm_element_hierarchy.element_id = crm_party.seq_party_id AND party_code = '1705150'	WHERE CustomerCode = '1705150'	source[0].std_code.should.equal(destination[0].MobilePhone)	one to one
FROM lumo.nc_client, lumo.crm_party, lumo.crm_element_hierarchy WHERE nc_client.seq_party_id = crm_party.seq_party_id AND crm_element_hierarchy.element_id = crm_party.seq_party_id AND party_code = '1705150'	WHERE CustomerCode = '1705150'	source[0].email_address.should.equal(destination[0].Email)	one to one
FROM lumo.nc_client, lumo.crm_party, lumo.crm_element_hierarchy WHERE nc_client.seq_party_id = crm_party.seq_party_id AND crm_element_hierarchy.element_id = crm_party.seq_party_id AND party_code = '1705150'	WHERE CustomerCode = '1705150'	source[0].date_of_birth.should.equal(destination[0].DateOfBirth)	one to one
FROM lumo.nc_client, lumo.crm_party, lumo.crm_element_hierarchy WHERE nc_client.seq_party_id = crm_party.seq_party_id AND crm_element_hierarchy.element_id = crm_party.seq_party_id AND party_code = '1705150'	WHERE CustomerCode = '1705150'	source[0].seq_element_type_id.should.equal(destination[0].CustomerType)	one to one