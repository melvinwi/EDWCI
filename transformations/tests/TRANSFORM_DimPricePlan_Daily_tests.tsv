# design test artefact                      	                                   	                                                                     	
# ARTEFACT: TRANSFORM_DimPricePlan_Daily_tests      	                                   	                                                                     	
# DESCRIPTION: Test each transformation rule	                                   	                                                                     	
SOURCE_SELECTION_CRITERIA                   	DESTINATION_SELECTION_CRITERIA     	TEST                                                                 	DESCRIPTION
REUSE_SQL                                   	"FROM /* Staging */ [schema].utl_price_plan LEFT JOIN (SELECT value_code.price_plan_code, value_code.variation_from_market, value_code.Meta_LatestUpdate_TaskExecutionInstanceId, row_number() OVER (PARTITION BY value_code.price_plan_code ORDER BY value_code.Meta_LatestUpdate_TaskExecutionInstanceId DESC) AS recency FROM /* Staging */ [schema].value_code) AS _value_code ON _value_code.price_plan_code = utl_price_plan.price_plan_code AND _value_code.recency = 1 WHERE utl_price_plan.Meta_LatestUpdate_TaskExecutionInstanceId > -2 OR _value_code.Meta_LatestUpdate_TaskExecutionInstanceId > -2"	                                                                     	
[REUSE_SQL]                                 	                                   	source.length.should.equal(destination.length)                       	row counts should match
