# design test artefact			
# ARTEFACT: TRANSFORM_FactPricePlanRate_Usage_Gas_tests			
# DESCRIPTION: Test each transformation rule			
SOURCE_SELECTION_CRITERIA	DESTINATION_SELECTION_CRITERIA	TEST	DESCRIPTION
REUSE_SQL	"FROM /* Staging */ [schema].utl_pp_schedule INNER JOIN  (SELECT MAX (utl_pp_schedule.sched_id) AS sched_id, utl_pp_schedule.price_plan_id FROM /* Staging */ [schema].utl_pp_schedule WHERE utl_pp_schedule.sched_type_id = 12 GROUP BY utl_pp_schedule.price_plan_id) AS _applicablePricePlans ON _applicablePricePlans.sched_id = utl_pp_schedule.sched_id INNER JOIN /* Staging */ [schema].utl_pp_schedule_rate ON utl_pp_schedule_rate.sched_id = utl_pp_schedule.sched_id INNER JOIN staticDims.DimPricePlan AS _DimPricePlan ON _DimPricePlan.PricePlanKey = N'USAGE.' + CAST ( utl_pp_schedule.price_plan_id AS nvarchar(10)) + N'.G' AND _DimPricePlan.Meta_IsCurrent = 1 INNER JOIN staticDims.DimUnitType AS _DimUnitType ON _DimUnitType.UnitTypeName = N'Days'AND _DimUnitType.Meta_IsCurrent = 1 INNER JOIN /* Staging */ [schema].utl_pp_schedule_type ON utl_pp_schedule_type.sched_type_id = utl_pp_schedule.sched_type_id WHERE utl_pp_schedule.Meta_LatestUpdate_TaskExecutionInstanceId > -2 OR utl_pp_schedule_rate.Meta_LatestUpdate_TaskExecutionInstanceId > -2 OR _DimPricePlan.Meta_LatestUpdate_TaskExecutionInstanceId > -2"		
[REUSE_SQL]		source.length.should.equal(destination.length)	row counts should match
