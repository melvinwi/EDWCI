# design test artefact			
# ARTEFACT: TRANSFORM_DimService_tests			
# DESCRIPTION: Test each transformation rule			
SOURCE_SELECTION_CRITERIA	DESTINATION_SELECTION_CRITERIA	TEST	DESCRIPTION
REUSE_SQL	FROM [schema].utl_site WHERE utl_site.Meta_LatestUpdate_TaskExecutionInstanceId  > -2		
[REUSE_SQL]		source.length.should.equal(destination.length)	row counts should match
[REUSE_SQL] AND site_id = '696059'	WHERE ServiceKey = '696059'	source[0].site_id.should.equal(destination[0].ServiceKey)	1:1 map rule plus int cast
[REUSE_SQL] AND site_id = '696059'	WHERE ServiceKey = '696059'	source[0].site_identifier.should.equal(destination[0].MarketIdentifier)	1:1 map rule plus int cast
[REUSE_SQL] AND site_id = '696059'	WHERE ServiceKey = '696059'	((source[0].seq_product_type_id == '1') ? 'Internet' : (source[0].seq_product_type_id == '2') ? 'Electricity' : (source[0].seq_product_type_id == '3') ? 'Gas' : (source[0].seq_product_type_id == '7') ? 'Telco' : '{Unknown}').should.equal(destination[0].ServiceType)	Decode Service Type (Electricity)
[REUSE_SQL] AND site_id = '1206636'	WHERE ServiceKey = '1206636'	((source[0].seq_product_type_id == '1') ? 'Internet' : (source[0].seq_product_type_id == '2') ? 'Electricity' : (source[0].seq_product_type_id == '3') ? 'Gas' : (source[0].seq_product_type_id == '7') ? 'Telco' : '{Unknown}').should.equal(destination[0].ServiceType)	Decode Service Type (Gas)
