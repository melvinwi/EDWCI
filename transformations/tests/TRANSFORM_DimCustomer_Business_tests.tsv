# design test artefact			
# ARTEFACT: TRANSFORM_DimCustomer_Residential_tests			
# DESCRIPTION: Test each transformation rule			
SOURCE_SELECTION_CRITERIA	DESTINATION_SELECTION_CRITERIA	TEST	DESCRIPTION
"FROM lumo.crm_party, lumo.nc_client, lumo.crm_element_hierarchy, lumo.crm_element_hierarchy AS _crm_element_hierarchy2, lumo.crm_party AS _crm_party2, lumo.crm_party_flag WHERE nc_client.seq_party_id = crm_party.seq_party_id AND crm_element_hierarchy.element_id = crm_party.seq_party_id AND crm_element_hierarchy.seq_element_type_id = '8' AND _crm_element_hierarchy2.parent_id = nc_client.seq_party_id AND _crm_element_hierarchy2.active = 'Y' AND _crm_element_hierarchy2.element_struct_code = 'CONTACT' AND _crm_party2.seq_party_id = _crm_element_hierarchy2.element_id AND crm_party_flag.seq_party_id = _crm_party2.seq_party_id AND crm_party_flag.seq_party_flag_type_id = '1'"		source.length.should.equal(destination.length)	row counts should match
"FROM lumo.crm_party, lumo.nc_client, lumo.crm_element_hierarchy, lumo.crm_element_hierarchy AS _crm_element_hierarchy2, lumo.crm_party AS _crm_party2, lumo.crm_party_flag WHERE nc_client.seq_party_id = crm_party.seq_party_id AND crm_element_hierarchy.element_id = crm_party.seq_party_id AND crm_element_hierarchy.seq_element_type_id = '8' AND _crm_element_hierarchy2.parent_id = nc_client.seq_party_id AND _crm_element_hierarchy2.active = 'Y' AND _crm_element_hierarchy2.element_struct_code = 'CONTACT' AND _crm_party2.seq_party_id = _crm_element_hierarchy2.element_id AND crm_party_flag.seq_party_id = _crm_party2.seq_party_id AND crm_party_flag.seq_party_flag_type_id = '1' AND crm_party.party_code = '1840601' "	WHERE `CustomerCode` = '1840601'	parseInt(source[0].party_code).should.equal(destination[0].CustomerCode)	1:1 map rule plus int cast
"FROM lumo.crm_party, lumo.nc_client, lumo.crm_element_hierarchy, lumo.crm_element_hierarchy AS _crm_element_hierarchy2, lumo.crm_party AS _crm_party2, lumo.crm_party_flag WHERE nc_client.seq_party_id = crm_party.seq_party_id AND crm_element_hierarchy.element_id = crm_party.seq_party_id AND crm_element_hierarchy.seq_element_type_id = '8' AND _crm_element_hierarchy2.parent_id = nc_client.seq_party_id AND _crm_element_hierarchy2.active = 'Y' AND _crm_element_hierarchy2.element_struct_code = 'CONTACT' AND _crm_party2.seq_party_id = _crm_element_hierarchy2.element_id AND crm_party_flag.seq_party_id = _crm_party2.seq_party_id AND crm_party_flag.seq_party_flag_type_id = '1' AND crm_party.party_code = '1840601' "	WHERE `CustomerCode` = '1840601'	parseInt(source[0].seq_party_id).should.equal(destination[0].CustomerKey)	1:1 map rule plus int cast
"FROM lumo.crm_party, lumo.nc_client, lumo.crm_element_hierarchy, lumo.crm_element_hierarchy AS _crm_element_hierarchy2, lumo.crm_party AS _crm_party2, lumo.crm_party_flag WHERE nc_client.seq_party_id = crm_party.seq_party_id AND crm_element_hierarchy.element_id = crm_party.seq_party_id AND crm_element_hierarchy.seq_element_type_id = '8' AND _crm_element_hierarchy2.parent_id = nc_client.seq_party_id AND _crm_element_hierarchy2.active = 'Y' AND _crm_element_hierarchy2.element_struct_code = 'CONTACT' AND _crm_party2.seq_party_id = _crm_element_hierarchy2.element_id AND crm_party_flag.seq_party_id = _crm_party2.seq_party_id AND crm_party_flag.seq_party_flag_type_id = '1' AND crm_party.party_code = '1840601' "	WHERE `CustomerCode` = '1840601'	((source[0].seq_element_type_id == '9') ? 'Residential' : (source[0].seq_element_type_id == '8') ? 'Business' : 'Unknown').should.equal(destination[0].CustomerType.trim())	1:1 map rule plus trim (Business)
