# design artefact				
# ARTEFACT: TRANSFORM_DimActivityType				
# DESCRIPTION: Promote DimMarketingOffer from spreadsheet sourced tables to DataStore				
SOURCE_FUNCTION_PREFIX	SOURCE	SOURCE_FUNCTION_SUFFIX	DESTINATION	DESCRIPTION
WITH_STATEMENTS	"WITH Complaints AS  (  SELECT [seq_act_type_id], [act_type_Code], [act_type_desc] FROM [schema].crm_activity_type WHERE seq_act_category_id IN (7,33,59) AND Meta_LatestUpdate_TaskExecutionInstanceId > @LatestSuccessfulTaskExecutionInstanceID) , Enquiries AS (  SELECT  _ca.[seq_act_type_id], _ca.[act_type_Code], _ca.[act_type_desc]  FROM [schema].[crm_activity_type]  _ca  JOIN (SELECT DISTINCT    seq_act_type_id    FROM [schema].[crm_activity]    WHERE 1=1    AND  seq_act_source_id IN(3,6,8,13,22)         ) _crm_activity    ON _ca.[seq_act_type_id] = _crm_activity.[seq_act_type_id]      WHERE 1=1  AND Meta_LatestUpdate_TaskExecutionInstanceId > @LatestSuccessfulTaskExecutionInstanceID   ) ,DisconnectionNotice AS (    SELECT _ca.[seq_act_type_id], _ca.[act_type_Code], _ca.[act_type_desc]   FROM [schema].[crm_activity_type] _ca   JOIN (SELECT DISTINCT     seq_act_type_id     FROM [schema].[ar_treatment_detail]      WHERE  1=1     AND   treat_det_id IN (3,4,5,6)      ) _crm_activity    ON _ca.[seq_act_type_id] = _crm_activity.[seq_act_type_id]   WHERE 1=1   AND Meta_LatestUpdate_TaskExecutionInstanceId > @LatestSuccessfulTaskExecutionInstanceID   )"			
CAST(	_ActivityType.seq_act_type_id	AS int)	DimActivityType.ActivityTypeKey	One to one mapping
CAST(	_ActivityType.act_type_code	AS nvarchar(20))	DimActivityType.ActivityTypeCode	One to one mapping
CAST(	_ActivityType.act_type_desc	AS nvarchar(100))	DimActivityType.ActivityTypeDesc	One to one mapping
SELECTION_CRITERIA	FROM (SELECT * FROM Complaints UNION SELECT * FROM Enquiries UNION SELECT * FROM DisconnectionNotice) _ActivityType			
